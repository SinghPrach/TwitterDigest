from pathlib import Path
import pandas as pd

base_path = Path("/Users/prachisingh/PyCharmMiscProject/Month/")  # year/month

dfs = []

for file in base_path.rglob("*.csv"):
    df = pd.read_csv(
        file,
        header=0   # first row is header (default)
    )
    df["source_file"] = file.stem
    dfs.append(df)

monthly_df = pd.concat(dfs, ignore_index=True)

output_path = "/Users/prachisingh/PyCharmMiscProject/monthly_2025_01.csv"

monthly_df.to_csv(
    output_path,
    index=False
)
